/*
 *  subscribe2 - v0.0.1
 *  A jQuery based email subscription widget with Google forms as backend.
 *
 *  Made by Abhas Tandon
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="subscribe2",g={buttonText:"Request Invite",errorMessages:{client:"Please enter a valid email address.",server:"Error contacting server"},options:{method:"google",formkey:"1eiFxDZOpcyjPo9ub7nIwp6vAKUkLIiOxXIPT1TtQvoQ",datakey:"entry.57553044"},successMessage:"Thanks. We have added you to our list and you will be notified soon."};a.extend(e.prototype,{init:function(){this.appendSubscribeBox()},postForm:function(b){var c={},d=this;c[this.settings.options.datakey]=b;var e=function(){d.inputView.css({display:"none"}),d.successMessage.css({display:"block"}).html(d.settings.successMessage)};a.ajax({url:"https://docs.google.com/forms/d/"+this.settings.options.formkey+"/formResponse",type:"POST",dataType:"xml",statusCode:{0:e,200:e},data:c})},submitHandler:function(){var b=a(this.element).find(".subscribe2-control-input").val();this.validateEmail(b)?(this.errorMessage.css({display:"none"}),this.postForm(b)):this.errorMessage.html(this.settings.errorMessages.client).css({display:"block"})},inputKeyUp:function(b){var c=a(this.element).find(".subscribe2-control-input").val();13===b.which?this.submitHandler():(this.errorMessage.css({display:"none"}),this.validateEmail(c)?this.validationStatusIcon.css({display:"block"}).addClass("subscribe2-valid").removeClass("subscribe2-invalid").html("&#x2713;"):this.validationStatusIcon.css({display:"block"}).addClass("subscribe2-invalid").removeClass("subscribe2-valid").html("x"))},validateEmail:function(a){var b=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},appendSubscribeBox:function(){var b=a("<div>",{"class":"subscribe2-input-wrp"}),c=a("<input>",{type:"email","class":"subscribe2-control-input",placeholder:"Email",keyup:this.inputKeyUp.bind(this)});this.validationStatusIcon=a("<div>",{"class":"subscribe2-validation-status",css:{display:"none"}}),b.append(c,this.validationStatusIcon);var d=a("<button>",{text:this.settings.buttonText,"class":"subscribe2-btn",click:this.submitHandler.bind(this)});this.errorMessage=a("<div>",{"class":"subscribe2-error",css:{display:"none"}}),this.successMessage=a("<div>",{"class":"subscribe2-success",css:{display:"none"}});var e=a("<div>",{css:{clear:"both"}});this.inputView=a("<div>",{"class":"subscribe2-input-view",append:[this.errorMessage,b,d,e]});var f=a("<div>",{"class":"subscribe2-wrp"});a(this.element).append(f.append(this.inputView,this.successMessage))}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);